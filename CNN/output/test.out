nohup: ignoring input
Using device: cuda
Building dataloaders (only test loader will be used)...
Loading existing splits...
DataLoaders ready.
#train batches: 162, #val batches: 35, #test batches: 35
#classes: 47
Loading checkpoint from: /data6/erfan/464/project/CNN/output/cnn_best.pt
Running inference on test set...

=== Test set metrics ===
Accuracy     : 0.7781
Macro F1     : 0.7715
Micro F1     : 0.7781
Weighted F1  : 0.7763

=== Per-class metrics (good for imbalance) ===
                                            precision    recall  f1-score   support

     African Violet (Saintpaulia ionantha)     0.8519    0.9020    0.8762        51
                                 Aloe Vera     0.9688    0.8378    0.8986        37
          Anthurium (Anthurium andraeanum)     0.8333    0.7353    0.7812        68
             Areca Palm (Dypsis lutescens)     0.7742    0.8571    0.8136        28
       Asparagus Fern (Asparagus setaceus)     1.0000    0.7600    0.8636        25
                    Begonia (Begonia spp.)     0.5714    0.3429    0.4286        35
     Bird of Paradise (Strelitzia reginae)     0.9200    0.8519    0.8846        27
         Birds Nest Fern (Asplenium nidus)     0.8065    0.5682    0.6667        44
        Boston Fern (Nephrolepis exaltata)     0.8542    0.8913    0.8723        46
                                  Calathea     0.4590    0.5600    0.5045        50
      Cast Iron Plant (Aspidistra elatior)     0.6364    0.7000    0.6667        40
 Chinese Money Plant (Pilea peperomioides)     0.8276    0.8276    0.8276        58
             Chinese evergreen (Aglaonema)     0.7397    0.7013    0.7200        77
Christmas Cactus (Schlumbergera bridgesii)     0.8500    0.7234    0.7816        47
                             Chrysanthemum     0.5686    0.9355    0.7073        31
                                 Ctenanthe     0.6667    0.7692    0.7143        52
                Daffodils (Narcissus spp.)     0.8438    0.8571    0.8504        63
                                  Dracaena     0.6341    0.6667    0.6500        39
            Dumb Cane (Dieffenbachia spp.)     0.8333    0.8642    0.8485        81
              Elephant Ear (Alocasia spp.)     0.6341    0.5200    0.5714        50
                English Ivy (Hedera helix)     0.7805    0.8889    0.8312        36
          Hyacinth (Hyacinthus orientalis)     0.8824    0.9375    0.9091        48
    Iron Cross begonia (Begonia masoniana)     0.9286    0.9750    0.9512        40
               Jade plant (Crassula ovata)     0.9167    0.6226    0.7416        53
                                 Kalanchoe     0.6364    0.7368    0.6829        19
                     Lilium (Hemerocallis)     0.7125    0.7917    0.7500        72
  Lily of the valley (Convallaria majalis)     0.9483    0.8871    0.9167        62
             Money Tree (Pachira aquatica)     0.8333    0.6481    0.7292        54
   Monstera Deliciosa (Monstera deliciosa)     0.8036    0.5488    0.6522        82
                                    Orchid     0.7353    0.7143    0.7246        35
         Parlor Palm (Chamaedorea elegans)     0.8077    0.8400    0.8235        50
                                Peace lily     0.8958    0.7414    0.8113        58
        Poinsettia (Euphorbia pulcherrima)     0.6567    0.9565    0.7788        46
 Polka Dot Plant (Hypoestes phyllostachya)     0.8727    0.9412    0.9057        51
      Ponytail Palm (Beaucarnea recurvata)     0.8667    0.8966    0.8814        29
                         Pothos (Ivy arum)     0.7692    0.5556    0.6452        36
         Prayer Plant (Maranta leuconeura)     0.6707    0.9167    0.7746        60
   Rattlesnake Plant (Calathea lancifolia)     0.7377    0.9574    0.8333        47
             Rubber Plant (Ficus elastica)     0.7021    0.7674    0.7333        43
                Sago Palm (Cycas revoluta)     0.8824    1.0000    0.9375        30
                                Schefflera     0.6269    0.8571    0.7241        49
                  Snake plant (Sanseviera)     0.8475    0.8333    0.8403        60
                              Tradescantia     0.8810    0.7255    0.7957        51
                                     Tulip     0.8600    0.8431    0.8515        51
                             Venus Flytrap     0.7879    0.8667    0.8254        30
                                     Yucca     0.4545    0.5000    0.4762        10
         ZZ Plant (Zamioculcas zamiifolia)     0.9057    0.7273    0.8067        66

                                  accuracy                         0.7781      2217
                                 macro avg     0.7803    0.7776    0.7715      2217
                              weighted avg     0.7892    0.7781    0.7763      2217

Confusion matrix (rows=true, cols=pred):
[[46  0  0 ...  0  0  0]
 [ 0 31  0 ...  0  0  0]
 [ 0  0 50 ...  0  0  0]
 ...
 [ 0  0  0 ... 26  0  0]
 [ 0  0  0 ...  0  5  0]
 [ 0  0  0 ...  0  0 48]]
Class order: ['African Violet (Saintpaulia ionantha)', 'Aloe Vera', 'Anthurium (Anthurium andraeanum)', 'Areca Palm (Dypsis lutescens)', 'Asparagus Fern (Asparagus setaceus)', 'Begonia (Begonia spp.)', 'Bird of Paradise (Strelitzia reginae)', 'Birds Nest Fern (Asplenium nidus)', 'Boston Fern (Nephrolepis exaltata)', 'Calathea', 'Cast Iron Plant (Aspidistra elatior)', 'Chinese Money Plant (Pilea peperomioides)', 'Chinese evergreen (Aglaonema)', 'Christmas Cactus (Schlumbergera bridgesii)', 'Chrysanthemum', 'Ctenanthe', 'Daffodils (Narcissus spp.)', 'Dracaena', 'Dumb Cane (Dieffenbachia spp.)', 'Elephant Ear (Alocasia spp.)', 'English Ivy (Hedera helix)', 'Hyacinth (Hyacinthus orientalis)', 'Iron Cross begonia (Begonia masoniana)', 'Jade plant (Crassula ovata)', 'Kalanchoe', 'Lilium (Hemerocallis)', 'Lily of the valley (Convallaria majalis)', 'Money Tree (Pachira aquatica)', 'Monstera Deliciosa (Monstera deliciosa)', 'Orchid', 'Parlor Palm (Chamaedorea elegans)', 'Peace lily', 'Poinsettia (Euphorbia pulcherrima)', 'Polka Dot Plant (Hypoestes phyllostachya)', 'Ponytail Palm (Beaucarnea recurvata)', 'Pothos (Ivy arum)', 'Prayer Plant (Maranta leuconeura)', 'Rattlesnake Plant (Calathea lancifolia)', 'Rubber Plant (Ficus elastica)', 'Sago Palm (Cycas revoluta)', 'Schefflera', 'Snake plant (Sanseviera)', 'Tradescantia', 'Tulip', 'Venus Flytrap', 'Yucca', 'ZZ Plant (Zamioculcas zamiifolia)']
